!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("AniJS-RWWD");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var n=function(t){var n=["do","after","before","to"];t={rootDOMTravelScope:{},notifierCollection:{},init:function(){r._helperCollection={};var e=r._createDefaultHelper();t.registerHelper("default",e),r._helperDefaultIndex="default",t.rootDOMTravelScope=document,t.Parser=r.Parser,r._animationEndEvent=r._animationEndPrefix(),r._classNamesWhenAnim=""},setDOMRootTravelScope:function(e){var n,r=document;try{"document"===e?n=r:(n=r.querySelector(e))||(n=r)}catch(e){n=r}t.rootDOMTravelScope=n},run:function(){var e=[],n={};t.purgeAll(),t.notifierCollection={};var i,a=(e=r._findAniJSNodeCollection(t.rootDOMTravelScope)).length,o=0;for(o;o<a;o++)i=e[o],n=r._getParsedAniJSSentenceCollection(i.getAttribute("data-anijs")),r._setupElementAnim(i,n);var l=t.getNotifier("AniJSNotifier");l&&l.dispatchEvent("onRunFinished")},createAnimation:function(e,t){var n=t||"";r._setupElementAnim(n,e)},getHelper:function(e){var t=r._helperCollection;return t[e]||t.default},registerHelper:function(e,t){r._helperCollection[e]=t},purge:function(e){if(e&&""!==e&&" "!==e){var n=document.querySelectorAll(e),r=n.length,i=0;for(i;i<r;i++)t.EventSystem.purgeEventTarget(n[i])}},purgeAll:function(){t.EventSystem.purgeAll()},purgeEventTarget:function(e){t.EventSystem.purgeEventTarget(e)},setClassNamesWhenAnim:function(e){r._classNamesWhenAnim=" "+e},createNotifier:function(){return t.EventSystem.createEventTarget()},registerNotifier:function(e){var n=t.notifierCollection;return e.id&&e.value&&t.EventSystem.isEventTarget(e.value)?(n[e.id]=e.value,1):""},getNotifier:function(e){return t.notifierCollection[e]}};var r={};return r._createDefaultHelper=function(){return{removeAnim:function(e,t){e.target&&e.type&&t.nodeHelper.removeClass(e.target,t.behavior)},holdAnimClass:function(e,t){},fireOnce:function(e,t){t.eventSystem.removeEventListenerHelper(t.eventTarget,t.event.type,t.listener)},emit:function(e,n,r){var i=r[0]||null,a="";if(null!==i){(i=i.split(".")).length>1?(a=i[0],i=i[1]):(a="",i=i[0]);var o=t.getNotifier(a)||null;null!==o&&o.dispatchEvent(i)}n.hasRunned||n.run()}}},r._createParser=function(){return new Parser},r._setupElementAnim=function(e,t){var n,i,a,o,l=t.length,s=0;for(s;s<l;s++)a=(n=t[s]).after,i=n.before,o=n.behavior,a&&(n.after=r.Parser.parseDoDefinition(a)),i&&(n.before=r.Parser.parseDoDefinition(i)),o&&(n.behavior=r.Parser.parseDoDefinition(o)),r._setupElementSentenceAnim(e,n)},r._setupElementSentenceAnim=function(e,n){var i,a=r._eventHelper(n),o=r._eventTargetHelper(e,n);if(n.after&&r.Util.beArray(n.after)&&(i=n.after[0]),""!==a){var l,s=o.length,f=0;for(f;f<s;f++)if(l=o[f],t.EventSystem.isEventTarget(l)){var c=function(a){var o=r._behaviorTargetHelper(e,n,a),l=r._behaviorHelper(n),s=r._beforeHelper(e,n),f=r._afterHelper(e,n);""!==r._classNamesWhenAnim&&(r.Util.beArray(l)||(l+=r._classNamesWhenAnim));var v={behaviorTargetList:o,nodeHelper:r.NodeHelper,animationEndEvent:r._animationEndEvent,behavior:l,after:f,eventSystem:t.EventSystem,eventTarget:a.currentTarget,afterFunctionName:i,dataAniJSOwner:e,listener:c,event:a,before:s};new t.AnimationContext(v).runAll(v)};t.EventSystem.addEventListenerHelper(l,a,c,!1),t.EventSystem.registerEventHandle(l,a,c)}}},r._eventHelper=function(e){var t=e.event||"";return"animationend"===t?t=r._animationEndPrefix():"transitionend"===t&&(t=r._transitionEndPrefix()),t},r._eventTargetHelper=function(n,i){var a,o=[n],l=t.rootDOMTravelScope;if(i.eventTarget)if((a=r._notifierHelper(i.eventTarget)).length>0)o=a;else if("document"===i.eventTarget)o=[document];else if("window"===i.eventTarget)o=[e];else if(i.eventTarget.split)try{o=l.querySelectorAll(i.eventTarget)}catch(e){console.log("Ugly Selector Here"),o=[]}return o},r._behaviorTargetHelper=function(e,n,i){var a=[e],o=t.rootDOMTravelScope,l=n.behaviorTarget;if(l)if(r.Util.beArray(l)){var s=this._actionHelper(e,n,l);s&&r.Util.isFunction(s[0])&&(a=s[0](i,{dataAniJSOwner:e},r._paramsHelper(s)))}else if("target"===l&&i.currentTarget)a=[i.currentTarget];else{l=l.split("$").join(",");try{a=o.querySelectorAll(l)}catch(e){a=[]}}return a},r._behaviorHelper=function(e){return this._actionHelper({},e,e.behavior)},r._afterHelper=function(e,t){var n=t.after;return r.Util.beArray(n)?this._actionHelper(e,t,n):r._callbackHelper(e,t,n)},r._beforeHelper=function(e,t){var n=t.before;return r.Util.beArray(n)?this._actionHelper(e,t,n):r._callbackHelper(e,t,n)},r._actionHelper=function(e,t,n){var i,a=n||"";return r.Util.beArray(a)&&((i=r._callbackHelper(e,t,a[0]))?a[0]=i:a=a.join(" ")),a},r._callbackHelper=function(e,t,n){var i=n||"",a=r._helperHelper(t);if(i&&!r.Util.isFunction(i)){var o=r._helperCollection[a];i=!(!o||!r.Util.isFunction(o[i]))&&o[i]}return i},r._helperHelper=function(e){return e.helper||r._helperDefaultIndex},r._notifierHelper=function(e){var n=[];t.notifierCollection;if(e)if(e.id&&t.EventSystem.isEventTarget(e.value))n.push(e.value),t.registerNotifier(e);else if(e.split){notifierIDList=e.split("$");var r,i=notifierIDList.length,a=1;for(a;a<i;a++)if((r=notifierIDList[a])&&" "!==r){r=r.trim();var o=t.getNotifier(r);o||(o=t.EventSystem.createEventTarget(),t.registerNotifier({id:r,value:o})),n.push(o)}}return n},r._paramsHelper=function(e){for(var t=[],n=e.length;n-- >1;)t[n-1]=e[n];return t},r._getParsedAniJSSentenceCollection=function(e){return r.Parser.parse(e)},r._findAniJSNodeCollection=function(e){return e.querySelectorAll("[data-anijs]")},r._animationEndPrefix=function(){return["animationend","oAnimationEnd","animationend","webkitAnimationEnd"][r._endPrefixBrowserDetectionIndex()]},r._transitionEndPrefix=function(){return["transitionend","oTransitionEnd","transitionend","webkitTransitionEnd"][r._endPrefixBrowserDetectionIndex()]},r._endPrefixBrowserDetectionIndex=function(){for(var e=document.createElement("fe"),t="Animation",n=["animation","O"+t,"Moz"+t,"webkit"+t],r=0;r<n.length;r++)if(void 0!==e.style[n[r]])return r},t.AnimationContext=function(e){var n=this;n.init=function(e){n.behaviorTargetList=e.behaviorTargetList||[],n.nodeHelper=e.nodeHelper,n.animationEndEvent=e.animationEndEvent,n.behavior=e.behavior,n.after=e.after,n.eventSystem=e.eventSystem,n.eventTarget=e.eventTarget,n.afterFunctionName=e.afterFunctionName,n.dataAniJSOwner=e.dataAniJSOwner,n.listener=e.listener,n.event=e.event,n.before=e.before},n.doDefaultAction=function(e,t){var i,a=n,o=a.nodeHelper,l=a.animationEndEvent,s=a.after,f=a.afterFunctionName;a.eventSystem.addEventListenerHelper(e,l,function(e){e.stopPropagation(),a.eventSystem.removeEventListenerHelper(e.target,e.type,arguments.callee),s&&(r.Util.isFunction(s)?s(e,n):r.Util.beArray(s)&&s[0](e,n,r._paramsHelper(s)))}),"holdAnimClass"!==f&&"$holdAnimClass"!==f&&((i=e._ajLastBehavior)&&o.removeClass(e,i),e._ajLastBehavior=t),e.offsetWidth=e.offsetWidth,o.addClass(e,t)},n.doFunctionAction=function(e,t){var i=n.after,a={target:e};t[0](a,n,r._paramsHelper(t)),r.Util.isFunction(i)?i(a,n):r.Util.beArray(i)&&i[0](a,n,r._paramsHelper(i))},n.runAll=function(){var e,i,a=n,o=a.behaviorTargetList,l=o.length,s=(a.behavior,0),f=a.before,c=n.event;for(s;s<l;s++)i={behaviorTargetList:[o[s]],nodeHelper:n.nodeHelper,animationEndEvent:n.animationEndEvent,behavior:n.behavior,after:n.after,eventSystem:n.eventSystem,eventTarget:n.eventTarget,afterFunctionName:n.afterFunctionName,dataAniJSOwner:n.dataAniJSOwner,listener:n.listener,event:c},e=new t.AnimationContext(i),f?r.Util.isFunction(f)?f(c,e):r.Util.beArray(f)&&f[0](c,e,r._paramsHelper(f)):e.run()},n.run=function(){var e=n,t=e.behavior,i=e.behaviorTargetList[0];n.hasRunned=1,r.Util.beArray(t)?e.doFunctionAction(i,t):e.doDefaultAction(i,t)},n.init(e)},r.Parser={parse:function(e){return this.parseDeclaration(e)},parseDeclaration:function(e){var t,n,r=[],i=(t=e.split(";")).length,a=0;for(a;a<i;a++)n=this.parseSentence(t[a]),r.push(n);return r},parseSentence:function(e){var t,n,r={},i=(t=e.split(",")).length,a=0;for(a;a<i;a++)r[(n=this.parseDefinition(t[a])).key]=n.value;return r},parseDefinition:function(e){var t,r,i,a={},o=["behavior","after","before","behaviorTarget"];if((t=e.split(":")).length>1){if(r=t[0].trim(),i=t.length>2?(i=(i=t.slice(1)).join(":")).trim():t[1].trim(),a.value=i,"if"===r)r="event";else if("on"===r)r="eventTarget";else for(var l=n.length-1;l>=0;l--)r===n[l]&&("after"!==(r=o[l])&&"before"!==r||"$"===i[0]||(i="$"+i),i=this.parseDoDefinition(i));a.key=r,a.value=i}return a},parseDoDefinition:function(e){var t=/^\$(\w+)\s*/g.exec(e),n="",r=1;if(null!==t){n=t[1],doDefinitionArray=e.split(t[0])[1],doDefinitionArray=null!==doDefinitionArray?doDefinitionArray.split("|"):[],(e=[])[0]=n;for(var i=0;i<doDefinitionArray.length;i++)""!==doDefinitionArray[i]&&(e[r++]=doDefinitionArray[i].trim());return e}return e}},r.NodeHelper={addClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;n<r;++n)t[n]&&!new RegExp("(\\s+|^)"+t[n]+"(\\s+|$)").test(e.className)&&(e.className=""===e.className?t[n]:e.className.trim()+" "+t[n])},removeClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;n<r;++n)e.className=e.className.replace(new RegExp("(\\s+|^)"+t[n]+"(\\s+|$)")," ").trim()},hasClass:function(e,t){return t&&new RegExp("(\\s+|^)"+t+"(\\s+|$)").test(e.className)}},r.Util={isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},beArray:function(e){return Array.isArray(e)}},t.EventSystem={eventCollection:{},eventIdCounter:0,isEventTarget:function(e){return e.addEventListener?1:0},createEventTarget:function(){return new t.EventTarget},addEventListenerHelper:function(e,t,n,r){e.addEventListener(t,n,!1)},removeEventListenerHelper:function(e,t,n){e&&e.removeEventListener(t,n)},purgeAll:function(){var e,t,n=this,r=n.eventCollection,i=Object.keys(r),a=i.length,o=0;for(o;o<a;o++)(t=r[e=i[o]])&&t.handleCollection&&t.handleCollection.length>0&&n.purgeEventTarget(t.handleCollection[0].element),delete r[e]},purgeAllNodes:function(e){var t=e.querySelectorAll("*");size=t.length;for(var n=size-1;n>=0;n--)this.purgeEventTarget(t[n])},purgeEventTarget:function(e){var t,n=this,r=e._aniJSEventID;if(r){var i,a=(t=n.eventCollection[r].handleCollection).length,o=0;for(o;o<a;o++)i=t[o],n.removeEventListenerHelper(e,i.eventType,i.listener);n.eventCollection[r]=e._aniJSEventID=null,delete n.eventCollection[r],delete e._aniJSEventID}},registerEventHandle:function(e,t,n){var r=this,i=e._aniJSEventID,a=r.eventCollection,o={eventType:t,listener:n,element:e};if(i)a[i].handleCollection.push(o);else{var l={handleCollection:[o]};a[++r.eventIdCounter]=l,e._aniJSEventID=r.eventIdCounter}}},t.EventTarget=function(){this._listeners={}},t.EventTarget.prototype={constructor:t.EventTarget,addEventListener:function(e,t,n){var r=this;void 0===r._listeners[e]&&(r._listeners[e]=[]),r._listeners[e].push(t)},dispatchEvent:function(e){var t=this;if("string"==typeof e&&(e={type:e}),e.target||(e.target=t),!e.type)throw new Error("Event object missing 'type' property.");if(this._listeners[e.type]instanceof Array)for(var n=t._listeners[e.type],r=0,i=n.length;r<i;r++)n[r].call(t,e)},removeEventListener:function(e,t){var n=this;if(n._listeners[e]instanceof Array)for(var r=n._listeners[e],i=0,a=r.length;i<a;i++)if(r[i]===t){r.splice(i,1);break}}},t}(n||{});return n.init(),n.run(),"function"==typeof define&&define.amd&&define("anijs",[],function(){return n}),void 0===t&&(e.AniJS=n),n});